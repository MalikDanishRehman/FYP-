@page "/order/{type}"
@rendermode InteractiveServer
@* Namespace is automatically imported if in same folder, otherwise add @using *@

<div class="container mt-4">
    <div class="row">

        <div class="col-md-4 d-flex align-items-start">
            <img src="/images/@($"{type?.ToLower() ?? "default"}.jpg")"
                 alt="@type"
                 onerror="this.src='https://via.placeholder.com/300x400';"
                 class="supplier-type-img" />
        </div>

        <div class="col-md-8">
            <h3 class="mb-3 text-white text-decoration-underline">Nearby Water Suppliers</h3>

            <div id="map"></div>

            <hr class="my-4" />

            <h3 class="mb-3 text-white text-decoration-underline">Available Suppliers List</h3>

            <div class="row g-3 mb-4">
                @if (isLoading)
                {
                    <p class="text-white">Loading suppliers from database...</p>
                }
                else if (filteredSuppliers.Count == 0)
                {
                    <p class="text-danger">No suppliers found for: @type</p>
                }

                @foreach (var supplier in filteredSuppliers)
                {
                    <div class="col-md-4">
                        <div class="card shadow-sm bg-body">
                            <img src="https://via.placeholder.com/300x180" class="card-img-top" alt="@supplier.name">

                            <div class="card-body text-center">
                                <h5 class="card-title text-white">@supplier.name</h5>

                                <p class="card-text text-warning" style="font-size:20px;">
                                    @GetStars(supplier.rating)
                                </p>

                                <button @onclick="() => GoToDetails(supplier.name)"
                                        class="btn btn-primary btn-sm">
                                    Order Now
                                </button>
                            </div>
                        </div>
                    </div>
                }
            </div>

        </div>
    </div>
</div>